function initCache(){$(".b-mainControls__item").click(function(){if($(".b-pageIll").hasClass("processed"))return!1;var rand=Math.round(10*Math.random());return rand>9?($(".b-character.j-current").click(),setTimeout(function(){changeContent({lamp:!0,question:!0,skipCharChange:!0})},400),!1):void changeContent({lamp:!0,question:!0})}),$(".b-pageIll__lamp").click(function(){lightAndTalk(),changeContent({lamp:!0})})}function lightAndTalk(){return $(".b-pageIll").hasClass("processed")?!1:($(".b-pageIll").addClass("processed"),$(".b-pageIll__lamp").addClass("-state_active"),setTimeout(function(){$(".mouth").hide(),$(".b-pageIll__lamp").removeClass("-state_active"),$(".b-pageIll").removeClass("processed")},1e3),timerId=setInterval(function(){$(".mouth").toggle()},100),setTimeout(function(){clearInterval(timerId)},800),void 0)}function changeCharacter(){$(".b-character").click(function(){if($(".b-pageIll").hasClass("processed"))return!1;var charNum=($(this),$(this).index(".b-character")),charLength=$(".b-character").length;setCharacter(charLength>charNum+1?charNum+1:0)})}function setCharacter(num){$(".b-character.j-current").animate({top:600},100).removeClass("j-current"),$(".b-character").eq(num).animate({top:0},300).addClass("j-current")}function changeContent(obj){var que,ans,character,ansIndx,rand,queIndx=0,isRand=1,lamp=obj.lamp||!1,question=obj.question||!1,curQuestion=$(".b-pageContent__header span").html(),curAnswer=$(".b-pageContent__devanswerInner span").html();if(character=$(".j-current").attr("data-char"),lamp){ansIndx=Math.floor(Math.random()*answersCharacter[character].length);for(var randomAnswer=answersCharacter[character][ansIndx];randomAnswer==curAnswer;)ansIndx=Math.floor(Math.random()*answersCharacter[character].length),randomAnswer=answersCharacter[character][ansIndx];ans=randomAnswer}if(question)if(arrObj.length){if(rand=Math.round(10*Math.random()),rand>7){for(var indx=Math.floor(Math.random()*arrObj.length);curQuestion==arrObj[indx].que;)indx=Math.floor(Math.random()*arrObj.length);que=arrObj[indx].que,ans=arrObj[indx].ans,queIndx=indx,ansIndx=indx,isRand=0}}else{queIndx=Math.floor(Math.random()*questions.length);for(var randomQuestion=questions[queIndx];randomQuestion==curQuestion;)queIndx=Math.floor(Math.random()*questions.length),randomQuestion=questions[queIndx];que=randomQuestion,isRand=1}changeQuestion(que),changeAnswer(ans),window.location.hash=character+"/"+queIndx+"/"+ansIndx+"/"+isRand}function changeAnswer(ans){var answer=ans||!1;answer&&($(".b-pageContent__devanswerInner span").fadeOut("300"),setTimeout(function(){$(".b-pageContent__devanswerInner span").html(ans)},400),$(".b-pageContent__devanswerInner span").fadeIn())}function changeQuestion(que){var question=que||!1;question&&($(".b-pageIll").hasClass("processed")||lightAndTalk(),$(".b-pageContent__header span").fadeOut("300"),setTimeout(function(){$(".b-pageContent__header span").html(que)},400),$(".b-pageContent__header span").fadeIn())}function showPopup(){$(".b-pageContent__howtoLink").click(function(){$(".overlay, .l-popup").fadeIn()});var browser=$(".b-browsersMenu__item.-state_active").data("browser");if($(".b-browsersMenu__item.-type_"+browser).addClass("-state_active"),"opera"==browser){var operaClass=$(".b-browsersMenu__item.-state_active")[0].classList;-1!=$.inArray("-type_operaWebkit",operaClass)?$(".b-popup__content.-type_"+browser).addClass("-type_webkit"):$(".b-popup__content.-type_"+browser).removeClass("-type_webkit").addClass("-type_presto")}$(".b-popup__content.-type_"+browser).show(),$(".b-browsersMenu__item").click(function(){var thisbrowser=$(this).attr("data-browser");$(".b-browsersMenu__item").removeClass("-state_active"),$(this).addClass("-state_active"),$(".b-popup__content").fadeOut(),$(".b-popup__content.-type_"+thisbrowser).fadeIn()})}function closePopup(){$(".btn_close").click(function(){$(".overlay, .l-popup").fadeOut(),lightAndTalk(),changeContent({lamp:!0,question:!0}),setTimeout(function(){$("body").removeClass("withPopup")},700)}),$(document).keyup(function(e){27==e.keyCode&&($(".overlay, .l-popup").fadeOut(),$("body").removeClass("withPopup"))})}function initHash(){var hash=window.location.hash;"#howto"==hash&&$(window).load(function(){$(".b-pageContent__howtoLink").click()});var err=0,items=window.location.hash.substr(1).split("/"),char=items[0],questionIndex=items[1],answerIndex=items[2],isRand=items[3];if(items.forEach(function(elem){""===elem&&err++}),err||"howto"==char)$(window).load(function(){lightAndTalk(),changeContent({lamp:!0,question:!0})});else if(isRand?(que=questions[questionIndex],ans=answersCharacter[char][answerIndex]):(que=arrObj[questionIndex].que,ans=arrObj[answerIndex].ans),lightAndTalk(),"undefined"!=typeof que&&changeQuestion(que),"undefined"!=typeof ans&&changeAnswer(ans),$('.b-character[data-char="'+char+'"]').length&&char!=$(".b-character.j-current").data("c")){var charNum=$('.b-character[data-char="'+char+'"]').index(".b-character");setCharacter(charNum)}}function initCustomScroll(){$(".j-customScroll").mCustomScrollbar({axis:"y",theme:"minimal-dark",scrollInertia:0,mouseWheel:{scrollAmount:50,preventDefault:!0}})}!function(){for(var method,noop=function(){},methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],length=methods.length,console=window.console=window.console||{};length--;)method=methods[length],console[method]||(console[method]=noop)}(),function($,window,document){!function(init){var _rjs="function"==typeof define&&define.amd,_dlp="https:"==document.location.protocol?"https:":"http:",_url="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.11/jquery.mousewheel.min.js";_rjs||$.event.special.mousewheel||$("head").append(decodeURI("%3Cscript src="+_dlp+"//"+_url+"%3E%3C/script%3E")),init()}(function(){var pluginNS="mCustomScrollbar",pluginPfx="mCS",defaultSelector=".mCustomScrollbar",defaults={setWidth:!1,setHeight:!1,setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,autoHideScrollbar:!1,autoExpandScrollbar:!1,alwaysShowScrollbar:0,snapAmount:null,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1,disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{enable:!1,scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,advanced:{autoExpandHorizontalScroll:!1,autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:!0,updateOnSelectorChange:!1,releaseDraggableSelectors:!1},theme:"light",callbacks:{onInit:!1,onScrollStart:!1,onScroll:!1,onTotalScroll:!1,onTotalScrollBack:!1,whileScrolling:!1,onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0,onOverflowY:!1,onOverflowX:!1,onOverflowYNone:!1,onOverflowXNone:!1},live:!1,liveSelector:null},totalInstances=0,liveTimers={},removeLiveTimers=function(selector){liveTimers[selector]&&(clearTimeout(liveTimers[selector]),functions._delete.call(null,liveTimers[selector]))},oldIE=window.attachEvent&&!window.addEventListener?1:0,touchActive=!1,methods={init:function(options){var options=$.extend(!0,{},defaults,options),selector=functions._selector.call(this);if(options.live){var liveSelector=options.liveSelector||this.selector||defaultSelector,$liveSelector=$(liveSelector);if("off"===options.live)return void removeLiveTimers(liveSelector);liveTimers[liveSelector]=setTimeout(function(){$liveSelector.mCustomScrollbar(options),"once"===options.live&&$liveSelector.length&&removeLiveTimers(liveSelector)},500)}else removeLiveTimers(liveSelector);return options.setWidth=options.set_width?options.set_width:options.setWidth,options.setHeight=options.set_height?options.set_height:options.setHeight,options.axis=options.horizontalScroll?"x":functions._findAxis.call(null,options.axis),options.scrollInertia=options.scrollInertia>0&&options.scrollInertia<17?17:options.scrollInertia,"object"!=typeof options.mouseWheel&&1==options.mouseWheel&&(options.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),options.mouseWheel.scrollAmount=options.mouseWheelPixels?options.mouseWheelPixels:options.mouseWheel.scrollAmount,options.mouseWheel.normalizeDelta=options.advanced.normalizeMouseWheelDelta?options.advanced.normalizeMouseWheelDelta:options.mouseWheel.normalizeDelta,options.scrollButtons.scrollType=functions._findScrollButtonsType.call(null,options.scrollButtons.scrollType),functions._theme.call(null,options),$(selector).each(function(){var $this=$(this);if(!$this.data(pluginPfx)){$this.data(pluginPfx,{idx:++totalInstances,opt:options,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:$this.css("direction"),cbOffsets:null,trigger:null});var o=$this.data(pluginPfx).opt,htmlDataAxis=$this.data("mcs-axis"),htmlDataSbPos=$this.data("mcs-scrollbar-position"),htmlDataTheme=$this.data("mcs-theme");htmlDataAxis&&(o.axis=htmlDataAxis),htmlDataSbPos&&(o.scrollbarPosition=htmlDataSbPos),htmlDataTheme&&(o.theme=htmlDataTheme,functions._theme.call(null,o)),functions._pluginMarkup.call(this),methods.update.call(null,$this)}})},update:function(el){var selector=el||functions._selector.call(this);return $(selector).each(function(){var $this=$(this);if($this.data(pluginPfx)){var d=$this.data(pluginPfx),o=d.opt,mCSB_container=$("#mCSB_"+d.idx+"_container"),mCSB_dragger=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")];if(!mCSB_container.length)return;d.tweenRunning&&functions._stop.call(null,$this),$this.hasClass("mCS_disabled")&&$this.removeClass("mCS_disabled"),$this.hasClass("mCS_destroyed")&&$this.removeClass("mCS_destroyed"),functions._maxHeight.call(this),functions._expandContentHorizontally.call(this),"y"===o.axis||o.advanced.autoExpandHorizontalScroll||mCSB_container.css("width",functions._contentWidth(mCSB_container.children())),d.overflowed=functions._overflowed.call(this),functions._scrollbarVisibility.call(this),o.autoDraggerLength&&functions._setDraggerLength.call(this),functions._scrollRatio.call(this),functions._bindEvents.call(this);var to=[Math.abs(mCSB_container[0].offsetTop),Math.abs(mCSB_container[0].offsetLeft)];"x"!==o.axis&&(d.overflowed[0]?mCSB_dragger[0].height()>mCSB_dragger[0].parent().height()?functions._resetContentPosition.call(this):(functions._scrollTo.call(this,$this,to[0].toString(),{dir:"y",dur:0,overwrite:"none"}),d.contentReset.y=null):(functions._resetContentPosition.call(this),"y"===o.axis?functions._unbindEvents.call(this):"yx"===o.axis&&d.overflowed[1]&&functions._scrollTo.call(this,$this,to[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==o.axis&&(d.overflowed[1]?mCSB_dragger[1].width()>mCSB_dragger[1].parent().width()?functions._resetContentPosition.call(this):(functions._scrollTo.call(this,$this,to[1].toString(),{dir:"x",dur:0,overwrite:"none"}),d.contentReset.x=null):(functions._resetContentPosition.call(this),"x"===o.axis?functions._unbindEvents.call(this):"yx"===o.axis&&d.overflowed[0]&&functions._scrollTo.call(this,$this,to[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),functions._autoUpdate.call(this)}})},scrollTo:function(val,options){if("undefined"!=typeof val&&null!=val){var selector=functions._selector.call(this);return $(selector).each(function(){var $this=$(this);if($this.data(pluginPfx)){var d=$this.data(pluginPfx),o=d.opt,methodDefaults={trigger:"external",scrollInertia:o.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},methodOptions=$.extend(!0,{},methodDefaults,options),to=functions._arr.call(this,val),dur=methodOptions.scrollInertia>0&&methodOptions.scrollInertia<17?17:methodOptions.scrollInertia;to[0]=functions._to.call(this,to[0],"y"),to[1]=functions._to.call(this,to[1],"x"),methodOptions.moveDragger&&(to[0]*=d.scrollRatio.y,to[1]*=d.scrollRatio.x),methodOptions.dur=dur,setTimeout(function(){null!==to[0]&&"undefined"!=typeof to[0]&&"x"!==o.axis&&d.overflowed[0]&&(methodOptions.dir="y",methodOptions.overwrite="all",functions._scrollTo.call(this,$this,to[0].toString(),methodOptions)),null!==to[1]&&"undefined"!=typeof to[1]&&"y"!==o.axis&&d.overflowed[1]&&(methodOptions.dir="x",methodOptions.overwrite="none",functions._scrollTo.call(this,$this,to[1].toString(),methodOptions))},methodOptions.timeout)}})}},stop:function(){var selector=functions._selector.call(this);return $(selector).each(function(){var $this=$(this);$this.data(pluginPfx)&&functions._stop.call(null,$this)})},disable:function(r){var selector=functions._selector.call(this);return $(selector).each(function(){var $this=$(this);if($this.data(pluginPfx)){{var d=$this.data(pluginPfx);d.opt}functions._autoUpdate.call(this,"remove"),functions._unbindEvents.call(this),r&&functions._resetContentPosition.call(this),functions._scrollbarVisibility.call(this,!0),$this.addClass("mCS_disabled")}})},destroy:function(){var selector=functions._selector.call(this);return $(selector).each(function(){var $this=$(this);if($this.data(pluginPfx)){var d=$this.data(pluginPfx),o=d.opt,mCustomScrollBox=$("#mCSB_"+d.idx),mCSB_container=$("#mCSB_"+d.idx+"_container"),scrollbar=$(".mCSB_"+d.idx+"_scrollbar");o.live&&removeLiveTimers(selector),functions._autoUpdate.call(this,"remove"),functions._unbindEvents.call(this),functions._resetContentPosition.call(this),$this.removeData(pluginPfx),functions._delete.call(null,this.mcs),scrollbar.remove(),mCustomScrollBox.replaceWith(mCSB_container.contents()),$this.removeClass(pluginNS+" _"+pluginPfx+"_"+d.idx+" mCS-autoHide mCS-dir-rtl mCS_no_scrollbar mCS_disabled").addClass("mCS_destroyed")}})}},functions={_selector:function(){return"object"!=typeof $(this)||$(this).length<1?defaultSelector:this},_theme:function(obj){var fixedSizeScrollbarThemes=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],nonExpandedScrollbarThemes=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],disabledScrollButtonsThemes=["minimal","minimal-dark"],enabledAutoHideScrollbarThemes=["minimal","minimal-dark"],scrollbarPositionOutsideThemes=["minimal","minimal-dark"];obj.autoDraggerLength=$.inArray(obj.theme,fixedSizeScrollbarThemes)>-1?!1:obj.autoDraggerLength,obj.autoExpandScrollbar=$.inArray(obj.theme,nonExpandedScrollbarThemes)>-1?!1:obj.autoExpandScrollbar,obj.scrollButtons.enable=$.inArray(obj.theme,disabledScrollButtonsThemes)>-1?!1:obj.scrollButtons.enable,obj.autoHideScrollbar=$.inArray(obj.theme,enabledAutoHideScrollbarThemes)>-1?!0:obj.autoHideScrollbar,obj.scrollbarPosition=$.inArray(obj.theme,scrollbarPositionOutsideThemes)>-1?"outside":obj.scrollbarPosition},_findAxis:function(val){return"yx"===val||"xy"===val||"auto"===val?"yx":"x"===val||"horizontal"===val?"x":"y"},_findScrollButtonsType:function(val){return"stepped"===val||"pixels"===val||"step"===val||"click"===val?"stepped":"stepless"},_pluginMarkup:function(){var $this=$(this),d=$this.data(pluginPfx),o=d.opt,expandClass=o.autoExpandScrollbar?" mCSB_scrollTools_onDrag_expand":"",scrollbar=["<div id='mCSB_"+d.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+d.idx+"_scrollbar mCS-"+o.theme+" mCSB_scrollTools_vertical"+expandClass+"'><div class='mCSB_draggerContainer'><div id='mCSB_"+d.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+d.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+d.idx+"_scrollbar mCS-"+o.theme+" mCSB_scrollTools_horizontal"+expandClass+"'><div class='mCSB_draggerContainer'><div id='mCSB_"+d.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],wrapperClass="yx"===o.axis?"mCSB_vertical_horizontal":"x"===o.axis?"mCSB_horizontal":"mCSB_vertical",scrollbars="yx"===o.axis?scrollbar[0]+scrollbar[1]:"x"===o.axis?scrollbar[1]:scrollbar[0],contentWrapper="yx"===o.axis?"<div id='mCSB_"+d.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",autoHideClass=o.autoHideScrollbar?" mCS-autoHide":"",scrollbarDirClass="x"!==o.axis&&"rtl"===d.langDir?" mCS-dir-rtl":"";o.setWidth&&$this.css("width",o.setWidth),o.setHeight&&$this.css("height",o.setHeight),o.setLeft="y"!==o.axis&&"rtl"===d.langDir?"989999px":o.setLeft,$this.addClass(pluginNS+" _"+pluginPfx+"_"+d.idx+autoHideClass+scrollbarDirClass).wrapInner("<div id='mCSB_"+d.idx+"' class='mCustomScrollBox mCS-"+o.theme+" "+wrapperClass+"'><div id='mCSB_"+d.idx+"_container' class='mCSB_container' style='position:relative; top:"+o.setTop+"; left:"+o.setLeft+";' dir="+d.langDir+" /></div>");var mCustomScrollBox=$("#mCSB_"+d.idx),mCSB_container=$("#mCSB_"+d.idx+"_container");"y"===o.axis||o.advanced.autoExpandHorizontalScroll||mCSB_container.css("width",functions._contentWidth(mCSB_container.children())),"outside"===o.scrollbarPosition?("static"===$this.css("position")&&$this.css("position","relative"),$this.css("overflow","visible"),mCustomScrollBox.addClass("mCSB_outside").after(scrollbars)):(mCustomScrollBox.addClass("mCSB_inside").append(scrollbars),mCSB_container.wrap(contentWrapper)),functions._scrollButtons.call(this);var mCSB_dragger=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")];mCSB_dragger[0].css("min-height",mCSB_dragger[0].height()),mCSB_dragger[1].css("min-width",mCSB_dragger[1].width())},_contentWidth:function(el){return Math.max.apply(Math,el.map(function(){return $(this).outerWidth(!0)}).get())},_expandContentHorizontally:function(){var $this=$(this),d=$this.data(pluginPfx),o=d.opt,mCSB_container=$("#mCSB_"+d.idx+"_container");o.advanced.autoExpandHorizontalScroll&&"y"!==o.axis&&mCSB_container.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(mCSB_container[0].getBoundingClientRect().right+.4)-Math.floor(mCSB_container[0].getBoundingClientRect().left),position:"relative"}).unwrap()},_scrollButtons:function(){var $this=$(this),d=$this.data(pluginPfx),o=d.opt,mCSB_scrollTools=$(".mCSB_"+d.idx+"_scrollbar:first"),btnHTML=["<a href='#' class='mCSB_buttonUp' oncontextmenu='return false;' />","<a href='#' class='mCSB_buttonDown' oncontextmenu='return false;' />","<a href='#' class='mCSB_buttonLeft' oncontextmenu='return false;' />","<a href='#' class='mCSB_buttonRight' oncontextmenu='return false;' />"],btn=["x"===o.axis?btnHTML[2]:btnHTML[0],"x"===o.axis?btnHTML[3]:btnHTML[1],btnHTML[2],btnHTML[3]];o.scrollButtons.enable&&mCSB_scrollTools.prepend(btn[0]).append(btn[1]).next(".mCSB_scrollTools").prepend(btn[2]).append(btn[3])},_maxHeight:function(){var $this=$(this),d=$this.data(pluginPfx),mCustomScrollBox=(d.opt,$("#mCSB_"+d.idx)),mh=$this.css("max-height"),pct=-1!==mh.indexOf("%"),bs=$this.css("box-sizing");if("none"!==mh){var val=pct?$this.parent().height()*parseInt(mh)/100:parseInt(mh);"border-box"===bs&&(val-=$this.innerHeight()-$this.height()+($this.outerHeight()-$this.innerHeight())),mCustomScrollBox.css("max-height",Math.round(val))}},_setDraggerLength:function(){var $this=$(this),d=$this.data(pluginPfx),mCustomScrollBox=$("#mCSB_"+d.idx),mCSB_container=$("#mCSB_"+d.idx+"_container"),mCSB_dragger=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")],ratio=[mCustomScrollBox.height()/mCSB_container.outerHeight(!1),mCustomScrollBox.width()/mCSB_container.outerWidth(!1)],l=[parseInt(mCSB_dragger[0].css("min-height")),Math.round(ratio[0]*mCSB_dragger[0].parent().height()),parseInt(mCSB_dragger[1].css("min-width")),Math.round(ratio[1]*mCSB_dragger[1].parent().width())],h=oldIE&&l[1]<l[0]?l[0]:l[1],w=oldIE&&l[3]<l[2]?l[2]:l[3];mCSB_dragger[0].css({height:h,"max-height":mCSB_dragger[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":l[0]+"px"}),mCSB_dragger[1].css({width:w,"max-width":mCSB_dragger[1].parent().width()-10})},_scrollRatio:function(){var $this=$(this),d=$this.data(pluginPfx),mCustomScrollBox=$("#mCSB_"+d.idx),mCSB_container=$("#mCSB_"+d.idx+"_container"),mCSB_dragger=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")],scrollAmount=[mCSB_container.outerHeight(!1)-mCustomScrollBox.height(),mCSB_container.outerWidth(!1)-mCustomScrollBox.width()],ratio=[scrollAmount[0]/(mCSB_dragger[0].parent().height()-mCSB_dragger[0].height()),scrollAmount[1]/(mCSB_dragger[1].parent().width()-mCSB_dragger[1].width())];d.scrollRatio={y:ratio[0],x:ratio[1]}},_onDragClasses:function(el,action,xpnd){var expandClass=xpnd?"mCSB_dragger_onDrag_expanded":"",classes=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag"],scrollbar=el.closest(".mCSB_scrollTools");"active"===action?(el.toggleClass(classes[0]+" "+expandClass),scrollbar.toggleClass(classes[1]),el[0]._draggable=el[0]._draggable?0:1):el[0]._draggable||("hide"===action?(el.removeClass(classes[0]),scrollbar.removeClass(classes[1])):(el.addClass(classes[0]),scrollbar.addClass(classes[1])))},_overflowed:function(){var $this=$(this),d=$this.data(pluginPfx),mCustomScrollBox=$("#mCSB_"+d.idx),mCSB_container=$("#mCSB_"+d.idx+"_container"),contentHeight=null==d.overflowed?mCSB_container.height():mCSB_container.outerHeight(!1),contentWidth=null==d.overflowed?mCSB_container.width():mCSB_container.outerWidth(!1);return[contentHeight>mCustomScrollBox.height(),contentWidth>mCustomScrollBox.width()]},_resetContentPosition:function(){var $this=$(this),d=$this.data(pluginPfx),o=d.opt,mCustomScrollBox=$("#mCSB_"+d.idx),mCSB_container=$("#mCSB_"+d.idx+"_container"),mCSB_dragger=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")];if(functions._stop($this),("x"!==o.axis&&!d.overflowed[0]||"y"===o.axis&&d.overflowed[0])&&(mCSB_dragger[0].add(mCSB_container).css("top",0),functions._scrollTo($this,"_resetY")),"y"!==o.axis&&!d.overflowed[1]||"x"===o.axis&&d.overflowed[1]){var cx=dx=0;"rtl"===d.langDir&&(cx=mCustomScrollBox.width()-mCSB_container.outerWidth(!1),dx=Math.abs(cx/d.scrollRatio.x)),mCSB_container.css("left",cx),mCSB_dragger[1].css("left",dx),functions._scrollTo($this,"_resetX")}},_bindEvents:function(){function _mwt(){mousewheelTimeout=setTimeout(function(){$.event.special.mousewheel?(clearTimeout(mousewheelTimeout),functions._mousewheel.call($this[0])):_mwt()},1e3)}var $this=$(this),d=$this.data(pluginPfx),o=d.opt;if(!d.bindEvents){if(functions._draggable.call(this),o.contentTouchScroll&&functions._contentDraggable.call(this),o.mouseWheel.enable){var mousewheelTimeout;_mwt()}functions._draggerRail.call(this),functions._wrapperScroll.call(this),o.advanced.autoScrollOnFocus&&functions._focus.call(this),o.scrollButtons.enable&&functions._buttons.call(this),o.keyboard.enable&&functions._keyboard.call(this),d.bindEvents=!0}},_unbindEvents:function(){var $this=$(this),d=$this.data(pluginPfx),o=d.opt,namespace=pluginPfx+"_"+d.idx,sb=".mCSB_"+d.idx+"_scrollbar",sel=$("#mCSB_"+d.idx+",#mCSB_"+d.idx+"_container,#mCSB_"+d.idx+"_container_wrapper,"+sb+" .mCSB_draggerContainer,#mCSB_"+d.idx+"_dragger_vertical,#mCSB_"+d.idx+"_dragger_horizontal,"+sb+">a"),mCSB_container=$("#mCSB_"+d.idx+"_container");o.advanced.releaseDraggableSelectors&&sel.add($(o.advanced.releaseDraggableSelectors)),d.bindEvents&&($(document).unbind("."+namespace),sel.each(function(){$(this).unbind("."+namespace)}),clearTimeout($this[0]._focusTimeout),functions._delete.call(null,$this[0]._focusTimeout),clearTimeout(d.sequential.step),functions._delete.call(null,d.sequential.step),clearTimeout(mCSB_container[0].onCompleteTimeout),functions._delete.call(null,mCSB_container[0].onCompleteTimeout),d.bindEvents=!1)},_scrollbarVisibility:function(disabled){var $this=$(this),d=$this.data(pluginPfx),o=d.opt,contentWrapper=$("#mCSB_"+d.idx+"_container_wrapper"),content=contentWrapper.length?contentWrapper:$("#mCSB_"+d.idx+"_container"),scrollbar=[$("#mCSB_"+d.idx+"_scrollbar_vertical"),$("#mCSB_"+d.idx+"_scrollbar_horizontal")],mCSB_dragger=[scrollbar[0].find(".mCSB_dragger"),scrollbar[1].find(".mCSB_dragger")];"x"!==o.axis&&(d.overflowed[0]&&!disabled?(scrollbar[0].add(mCSB_dragger[0]).add(scrollbar[0].children("a")).css("display","block"),content.removeClass("mCS_no_scrollbar_y mCS_y_hidden")):(o.alwaysShowScrollbar?(2!==o.alwaysShowScrollbar&&mCSB_dragger[0].add(scrollbar[0].children("a")).css("display","none"),content.removeClass("mCS_y_hidden")):(scrollbar[0].css("display","none"),content.addClass("mCS_y_hidden")),content.addClass("mCS_no_scrollbar_y"))),"y"!==o.axis&&(d.overflowed[1]&&!disabled?(scrollbar[1].add(mCSB_dragger[1]).add(scrollbar[1].children("a")).css("display","block"),content.removeClass("mCS_no_scrollbar_x mCS_x_hidden")):(o.alwaysShowScrollbar?(2!==o.alwaysShowScrollbar&&mCSB_dragger[1].add(scrollbar[1].children("a")).css("display","none"),content.removeClass("mCS_x_hidden")):(scrollbar[1].css("display","none"),content.addClass("mCS_x_hidden")),content.addClass("mCS_no_scrollbar_x"))),d.overflowed[0]||d.overflowed[1]?$this.removeClass("mCS_no_scrollbar"):$this.addClass("mCS_no_scrollbar")},_coordinates:function(e){var t=e.type;switch(t){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return[e.originalEvent.pageY,e.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var touch=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],touches=e.originalEvent.touches.length||e.originalEvent.changedTouches.length;return[touch.pageY,touch.pageX,touches>1];default:return[e.pageY,e.pageX,!1]}},_draggable:function(){function _iframe(evt){var el=mCSB_container.find("iframe");if(el.length){var val=evt?"auto":"none";el.css("pointer-events",val)}}function _drag(dragY,dragX,y,x){if(mCSB_container[0].idleTimer=o.scrollInertia<233?250:0,draggable.attr("id")===draggerId[1])var dir="x",to=(draggable[0].offsetLeft-dragX+x)*d.scrollRatio.x;else var dir="y",to=(draggable[0].offsetTop-dragY+y)*d.scrollRatio.y;functions._scrollTo($this,to.toString(),{dir:dir,drag:!0})}var draggable,dragY,dragX,$this=$(this),d=$this.data(pluginPfx),o=d.opt,namespace=pluginPfx+"_"+d.idx,draggerId=["mCSB_"+d.idx+"_dragger_vertical","mCSB_"+d.idx+"_dragger_horizontal"],mCSB_container=$("#mCSB_"+d.idx+"_container"),mCSB_dragger=$("#"+draggerId[0]+",#"+draggerId[1]),rds=o.advanced.releaseDraggableSelectors?mCSB_dragger.add($(o.advanced.releaseDraggableSelectors)):mCSB_dragger;mCSB_dragger.bind("mousedown."+namespace+" touchstart."+namespace+" pointerdown."+namespace+" MSPointerDown."+namespace,function(e){if(e.stopImmediatePropagation(),e.preventDefault(),functions._mouseBtnLeft(e)){touchActive=!0,oldIE&&(document.onselectstart=function(){return!1}),_iframe(!1),functions._stop($this),draggable=$(this);var offset=draggable.offset(),y=functions._coordinates(e)[0]-offset.top,x=functions._coordinates(e)[1]-offset.left,h=draggable.height()+offset.top,w=draggable.width()+offset.left;h>y&&y>0&&w>x&&x>0&&(dragY=y,dragX=x),functions._onDragClasses(draggable,"active",o.autoExpandScrollbar)}}).bind("touchmove."+namespace,function(e){e.stopImmediatePropagation(),e.preventDefault();var offset=draggable.offset(),y=functions._coordinates(e)[0]-offset.top,x=functions._coordinates(e)[1]-offset.left;_drag(dragY,dragX,y,x)}),$(document).bind("mousemove."+namespace+" pointermove."+namespace+" MSPointerMove."+namespace,function(e){if(draggable){var offset=draggable.offset(),y=functions._coordinates(e)[0]-offset.top,x=functions._coordinates(e)[1]-offset.left;if(dragY===y)return;_drag(dragY,dragX,y,x)}}).add(rds).bind("mouseup."+namespace+" touchend."+namespace+" pointerup."+namespace+" MSPointerUp."+namespace,function(){draggable&&(functions._onDragClasses(draggable,"active",o.autoExpandScrollbar),draggable=null),touchActive=!1,oldIE&&(document.onselectstart=null),_iframe(!0)})},_contentDraggable:function(){function _m(ds,s){var r=[1.5*s,2*s,s/1.5,s/2];return ds>90?s>4?r[0]:r[3]:ds>60?s>3?r[3]:r[2]:ds>30?s>8?r[1]:s>6?r[0]:s>4?s:r[2]:s>8?s:r[3]}function _drag(amount,dur,easing,dir,overwrite,drag){amount&&functions._scrollTo($this,amount.toString(),{dur:dur,scrollEasing:easing,dir:dir,overwrite:overwrite,drag:drag})}var dragY,dragX,touchStartY,touchStartX,startTime,runningTime,endTime,distance,speed,amount,durB,$this=$(this),d=$this.data(pluginPfx),o=d.opt,namespace=pluginPfx+"_"+d.idx,mCustomScrollBox=$("#mCSB_"+d.idx),mCSB_container=$("#mCSB_"+d.idx+"_container"),mCSB_dragger=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")],touchMoveY=[],touchMoveX=[],durA=0,overwrite="yx"===o.axis?"none":"all",touchIntent=[];mCSB_container.bind("touchstart."+namespace+" pointerdown."+namespace+" MSPointerDown."+namespace,function(e){if(functions._pointerTouch(e)&&!touchActive&&!functions._coordinates(e)[2]){var offset=mCSB_container.offset();dragY=functions._coordinates(e)[0]-offset.top,dragX=functions._coordinates(e)[1]-offset.left,touchIntent=[functions._coordinates(e)[0],functions._coordinates(e)[1]]}}).bind("touchmove."+namespace+" pointermove."+namespace+" MSPointerMove."+namespace,function(e){if(functions._pointerTouch(e)&&!touchActive&&!functions._coordinates(e)[2]){e.stopImmediatePropagation(),runningTime=functions._getTime();var offset=mCustomScrollBox.offset(),y=functions._coordinates(e)[0]-offset.top,x=functions._coordinates(e)[1]-offset.left,easing="mcsLinearOut";if(touchMoveY.push(y),touchMoveX.push(x),touchIntent[2]=Math.abs(functions._coordinates(e)[0]-touchIntent[0]),touchIntent[3]=Math.abs(functions._coordinates(e)[1]-touchIntent[1]),d.overflowed[0])var limit=mCSB_dragger[0].parent().height()-mCSB_dragger[0].height(),prevent=dragY-y>0&&y-dragY>-(limit*d.scrollRatio.y)&&(2*touchIntent[3]<touchIntent[2]||"yx"===o.axis);if(d.overflowed[1])var limitX=mCSB_dragger[1].parent().width()-mCSB_dragger[1].width(),preventX=dragX-x>0&&x-dragX>-(limitX*d.scrollRatio.x)&&(2*touchIntent[2]<touchIntent[3]||"yx"===o.axis);(prevent||preventX)&&e.preventDefault(),amount="yx"===o.axis?[dragY-y,dragX-x]:"x"===o.axis?[null,dragX-x]:[dragY-y,null],mCSB_container[0].idleTimer=250,d.overflowed[0]&&_drag(amount[0],durA,easing,"y","all",!0),d.overflowed[1]&&_drag(amount[1],durA,easing,"x",overwrite,!0)}}),mCustomScrollBox.bind("touchstart."+namespace+" pointerdown."+namespace+" MSPointerDown."+namespace,function(e){if(functions._pointerTouch(e)&&!touchActive&&!functions._coordinates(e)[2]){e.stopImmediatePropagation(),functions._stop($this),startTime=functions._getTime();var offset=mCustomScrollBox.offset();touchStartY=functions._coordinates(e)[0]-offset.top,touchStartX=functions._coordinates(e)[1]-offset.left,touchMoveY=[],touchMoveX=[]}}).bind("touchend."+namespace+" pointerup."+namespace+" MSPointerUp."+namespace,function(e){if(functions._pointerTouch(e)&&!touchActive&&!functions._coordinates(e)[2]){e.stopImmediatePropagation(),endTime=functions._getTime();var offset=mCustomScrollBox.offset(),y=functions._coordinates(e)[0]-offset.top,x=functions._coordinates(e)[1]-offset.left;if(!(endTime-runningTime>30)){speed=1e3/(endTime-startTime);var easing="mcsEaseOut",slow=2.5>speed,diff=slow?[touchMoveY[touchMoveY.length-2],touchMoveX[touchMoveX.length-2]]:[0,0];distance=slow?[y-diff[0],x-diff[1]]:[y-touchStartY,x-touchStartX];var absDistance=[Math.abs(distance[0]),Math.abs(distance[1])];speed=slow?[Math.abs(distance[0]/4),Math.abs(distance[1]/4)]:[speed,speed];var a=[Math.abs(mCSB_container[0].offsetTop)-distance[0]*_m(absDistance[0]/speed[0],speed[0]),Math.abs(mCSB_container[0].offsetLeft)-distance[1]*_m(absDistance[1]/speed[1],speed[1])];
amount="yx"===o.axis?[a[0],a[1]]:"x"===o.axis?[null,a[1]]:[a[0],null],durB=[4*absDistance[0]+o.scrollInertia,4*absDistance[1]+o.scrollInertia];var md=parseInt(o.contentTouchScroll)||0;amount[0]=absDistance[0]>md?amount[0]:0,amount[1]=absDistance[1]>md?amount[1]:0,d.overflowed[0]&&_drag(amount[0],durB[0],easing,"y",overwrite,!1),d.overflowed[1]&&_drag(amount[1],durB[1],easing,"x",overwrite,!1)}}})},_mousewheel:function(){function _canAccessIFrame(iframe){var html=null;try{var doc=iframe.contentDocument||iframe.contentWindow.document;html=doc.body.innerHTML}catch(err){}return null!==html}var $this=$(this),d=$this.data(pluginPfx);if(d){var o=d.opt,namespace=pluginPfx+"_"+d.idx,mCustomScrollBox=$("#mCSB_"+d.idx),mCSB_dragger=[$("#mCSB_"+d.idx+"_dragger_vertical"),$("#mCSB_"+d.idx+"_dragger_horizontal")],iframe=$("#mCSB_"+d.idx+"_container").find("iframe"),el=mCustomScrollBox;iframe.length&&iframe.each(function(){var iFobj=this;_canAccessIFrame(iFobj)&&(el=el.add($(iFobj).contents().find("body")))}),el.bind("mousewheel."+namespace,function(e,delta){if(functions._stop($this),!functions._disableMousewheel($this,e.target)){var deltaFactor="auto"!==o.mouseWheel.deltaFactor?parseInt(o.mouseWheel.deltaFactor):oldIE&&e.deltaFactor<100?100:e.deltaFactor||100;if("x"===o.axis||"x"===o.mouseWheel.axis)var dir="x",px=[Math.round(deltaFactor*d.scrollRatio.x),parseInt(o.mouseWheel.scrollAmount)],amount="auto"!==o.mouseWheel.scrollAmount?px[1]:px[0]>=mCustomScrollBox.width()?.9*mCustomScrollBox.width():px[0],contentPos=Math.abs($("#mCSB_"+d.idx+"_container")[0].offsetLeft),draggerPos=mCSB_dragger[1][0].offsetLeft,limit=mCSB_dragger[1].parent().width()-mCSB_dragger[1].width(),dlt=e.deltaX||e.deltaY||delta;else var dir="y",px=[Math.round(deltaFactor*d.scrollRatio.y),parseInt(o.mouseWheel.scrollAmount)],amount="auto"!==o.mouseWheel.scrollAmount?px[1]:px[0]>=mCustomScrollBox.height()?.9*mCustomScrollBox.height():px[0],contentPos=Math.abs($("#mCSB_"+d.idx+"_container")[0].offsetTop),draggerPos=mCSB_dragger[0][0].offsetTop,limit=mCSB_dragger[0].parent().height()-mCSB_dragger[0].height(),dlt=e.deltaY||delta;"y"===dir&&!d.overflowed[0]||"x"===dir&&!d.overflowed[1]||(o.mouseWheel.invert&&(dlt=-dlt),o.mouseWheel.normalizeDelta&&(dlt=0>dlt?-1:1),(dlt>0&&0!==draggerPos||0>dlt&&draggerPos!==limit||o.mouseWheel.preventDefault)&&(e.stopImmediatePropagation(),e.preventDefault()),functions._scrollTo($this,(contentPos-dlt*amount).toString(),{dir:dir}))}})}},_disableMousewheel:function(el,target){var tag=target.nodeName.toLowerCase(),tags=el.data(pluginPfx).opt.mouseWheel.disableOver,focusTags=["select","textarea"];return $.inArray(tag,tags)>-1&&!($.inArray(tag,focusTags)>-1&&!$(target).is(":focus"))},_draggerRail:function(){var $this=$(this),d=$this.data(pluginPfx),namespace=pluginPfx+"_"+d.idx,mCSB_container=$("#mCSB_"+d.idx+"_container"),wrapper=mCSB_container.parent(),mCSB_draggerContainer=$(".mCSB_"+d.idx+"_scrollbar .mCSB_draggerContainer");mCSB_draggerContainer.bind("touchstart."+namespace+" pointerdown."+namespace+" MSPointerDown."+namespace,function(){touchActive=!0}).bind("touchend."+namespace+" pointerup."+namespace+" MSPointerUp."+namespace,function(){touchActive=!1}).bind("click."+namespace,function(e){if($(e.target).hasClass("mCSB_draggerContainer")||$(e.target).hasClass("mCSB_draggerRail")){functions._stop($this);var el=$(this),mCSB_dragger=el.find(".mCSB_dragger");if(el.parent(".mCSB_scrollTools_horizontal").length>0){if(!d.overflowed[1])return;var dir="x",clickDir=e.pageX>mCSB_dragger.offset().left?-1:1,to=Math.abs(mCSB_container[0].offsetLeft)-.9*clickDir*wrapper.width()}else{if(!d.overflowed[0])return;var dir="y",clickDir=e.pageY>mCSB_dragger.offset().top?-1:1,to=Math.abs(mCSB_container[0].offsetTop)-.9*clickDir*wrapper.height()}functions._scrollTo($this,to.toString(),{dir:dir,scrollEasing:"mcsEaseInOut"})}})},_focus:function(){var $this=$(this),d=$this.data(pluginPfx),o=d.opt,namespace=pluginPfx+"_"+d.idx,mCSB_container=$("#mCSB_"+d.idx+"_container"),wrapper=mCSB_container.parent();mCSB_container.bind("focusin."+namespace,function(){var el=$(document.activeElement),nested=mCSB_container.find(".mCustomScrollBox").length,dur=0;el.is(o.advanced.autoScrollOnFocus)&&(functions._stop($this),clearTimeout($this[0]._focusTimeout),$this[0]._focusTimer=nested?(dur+17)*nested:0,$this[0]._focusTimeout=setTimeout(function(){var to=[el.offset().top-mCSB_container.offset().top,el.offset().left-mCSB_container.offset().left],contentPos=[mCSB_container[0].offsetTop,mCSB_container[0].offsetLeft],isVisible=[contentPos[0]+to[0]>=0&&contentPos[0]+to[0]<wrapper.height()-el.outerHeight(!1),contentPos[1]+to[1]>=0&&contentPos[0]+to[1]<wrapper.width()-el.outerWidth(!1)],overwrite="yx"!==o.axis||isVisible[0]||isVisible[1]?"all":"none";"x"===o.axis||isVisible[0]||functions._scrollTo($this,to[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:overwrite,dur:dur}),"y"===o.axis||isVisible[1]||functions._scrollTo($this,to[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:overwrite,dur:dur})},$this[0]._focusTimer))})},_wrapperScroll:function(){var $this=$(this),d=$this.data(pluginPfx),namespace=pluginPfx+"_"+d.idx,wrapper=$("#mCSB_"+d.idx+"_container").parent();wrapper.bind("scroll."+namespace,function(){(0!==wrapper.scrollTop()||0!==wrapper.scrollLeft())&&$(".mCSB_"+d.idx+"_scrollbar").css("visibility","hidden")})},_buttons:function(){var $this=$(this),d=$this.data(pluginPfx),o=d.opt,seq=d.sequential,namespace=pluginPfx+"_"+d.idx,sel=($("#mCSB_"+d.idx+"_container"),".mCSB_"+d.idx+"_scrollbar"),btn=$(sel+">a");btn.bind("mousedown."+namespace+" touchstart."+namespace+" pointerdown."+namespace+" MSPointerDown."+namespace+" mouseup."+namespace+" touchend."+namespace+" pointerup."+namespace+" MSPointerUp."+namespace+" mouseout."+namespace+" pointerout."+namespace+" MSPointerOut."+namespace+" click."+namespace,function(e){function _seq(a,c){seq.scrollAmount=o.snapAmount||o.scrollButtons.scrollAmount,functions._sequentialScroll.call(this,$this,a,c)}if(e.preventDefault(),functions._mouseBtnLeft(e)){var btnClass=$(this).attr("class");switch(seq.type=o.scrollButtons.scrollType,e.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===seq.type)return;touchActive=!0,d.tweenRunning=!1,_seq("on",btnClass);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===seq.type)return;touchActive=!1,seq.dir&&_seq("off",btnClass);break;case"click":if("stepped"!==seq.type||d.tweenRunning)return;_seq("on",btnClass)}}})},_keyboard:function(){var $this=$(this),d=$this.data(pluginPfx),o=d.opt,seq=d.sequential,namespace=pluginPfx+"_"+d.idx,mCustomScrollBox=$("#mCSB_"+d.idx),mCSB_container=$("#mCSB_"+d.idx+"_container"),wrapper=mCSB_container.parent(),editables="input,textarea,select,datalist,keygen,[contenteditable='true']";mCustomScrollBox.attr("tabindex","0").bind("blur."+namespace+" keydown."+namespace+" keyup."+namespace,function(e){function _seq(a,c){seq.type=o.keyboard.scrollType,seq.scrollAmount=o.snapAmount||o.keyboard.scrollAmount,"stepped"===seq.type&&d.tweenRunning||functions._sequentialScroll.call(this,$this,a,c)}switch(e.type){case"blur":d.tweenRunning&&seq.dir&&_seq("off",null);break;case"keydown":case"keyup":var code=e.keyCode?e.keyCode:e.which,action="on";if("x"!==o.axis&&(38===code||40===code)||"y"!==o.axis&&(37===code||39===code)){if((38===code||40===code)&&!d.overflowed[0]||(37===code||39===code)&&!d.overflowed[1])return;"keyup"===e.type&&(action="off"),$(document.activeElement).is(editables)||(e.preventDefault(),e.stopImmediatePropagation(),_seq(action,code))}else if(33===code||34===code){if((d.overflowed[0]||d.overflowed[1])&&(e.preventDefault(),e.stopImmediatePropagation()),"keyup"===e.type){functions._stop($this);var keyboardDir=34===code?-1:1;if("x"===o.axis||"yx"===o.axis&&d.overflowed[1]&&!d.overflowed[0])var dir="x",to=Math.abs(mCSB_container[0].offsetLeft)-.9*keyboardDir*wrapper.width();else var dir="y",to=Math.abs(mCSB_container[0].offsetTop)-.9*keyboardDir*wrapper.height();functions._scrollTo($this,to.toString(),{dir:dir,scrollEasing:"mcsEaseInOut"})}}else if((35===code||36===code)&&!$(document.activeElement).is(editables)&&((d.overflowed[0]||d.overflowed[1])&&(e.preventDefault(),e.stopImmediatePropagation()),"keyup"===e.type)){if("x"===o.axis||"yx"===o.axis&&d.overflowed[1]&&!d.overflowed[0])var dir="x",to=35===code?Math.abs(wrapper.width()-mCSB_container.outerWidth(!1)):0;else var dir="y",to=35===code?Math.abs(wrapper.height()-mCSB_container.outerHeight(!1)):0;functions._scrollTo($this,to.toString(),{dir:dir,scrollEasing:"mcsEaseInOut"})}}})},_sequentialScroll:function(el,action,trigger){function _start(once){var c="stepped"!==seq.type,t=once?c?o.scrollInertia/1.5:o.scrollInertia:1e3/60,m=once?c?7.5:40:2.5,contentPos=[Math.abs(mCSB_container[0].offsetTop),Math.abs(mCSB_container[0].offsetLeft)],ratio=[d.scrollRatio.y>10?10:d.scrollRatio.y,d.scrollRatio.x>10?10:d.scrollRatio.x],amount="x"===seq.dir[0]?contentPos[1]+seq.dir[1]*ratio[1]*m:contentPos[0]+seq.dir[1]*ratio[0]*m,px="x"===seq.dir[0]?contentPos[1]+seq.dir[1]*parseInt(seq.scrollAmount):contentPos[0]+seq.dir[1]*parseInt(seq.scrollAmount),to="auto"!==seq.scrollAmount?px:amount,easing=once?c?"mcsLinearOut":"mcsEaseInOut":"mcsLinear",onComplete=once?!0:!1;return once&&17>t&&(to="x"===seq.dir[0]?contentPos[1]:contentPos[0]),functions._scrollTo(el,to.toString(),{dir:seq.dir[0],scrollEasing:easing,dur:t,onComplete:onComplete}),once?void(seq.dir=!1):(clearTimeout(seq.step),void(seq.step=setTimeout(function(){_start()},t)))}function _stop(){clearTimeout(seq.step),functions._stop(el)}var d=el.data(pluginPfx),o=d.opt,seq=d.sequential,mCSB_container=$("#mCSB_"+d.idx+"_container"),once="stepped"===seq.type?!0:!1;switch(action){case"on":if(seq.dir=["mCSB_buttonRight"===trigger||"mCSB_buttonLeft"===trigger||39===trigger||37===trigger?"x":"y","mCSB_buttonUp"===trigger||"mCSB_buttonLeft"===trigger||38===trigger||37===trigger?-1:1],functions._stop(el),functions._isNumeric(trigger)&&"stepped"===seq.type)return;_start(once);break;case"off":_stop(),(once||d.tweenRunning&&seq.dir)&&_start(!0)}},_arr:function(val){var o=$(this).data(pluginPfx).opt,vals=[];return"function"==typeof val&&(val=val()),val instanceof Array?vals=val.length>1?[val[0],val[1]]:"x"===o.axis?[null,val[0]]:[val[0],null]:(vals[0]=val.y?val.y:val.x||"x"===o.axis?null:val,vals[1]=val.x?val.x:val.y||"y"===o.axis?null:val),"function"==typeof vals[0]&&(vals[0]=vals[0]()),"function"==typeof vals[1]&&(vals[1]=vals[1]()),vals},_to:function(val,dir){if(null!=val&&"undefined"!=typeof val){var $this=$(this),d=$this.data(pluginPfx),o=d.opt,mCSB_container=$("#mCSB_"+d.idx+"_container"),wrapper=mCSB_container.parent(),t=typeof val;dir||(dir="x"===o.axis?"x":"y");var contentLength="x"===dir?mCSB_container.outerWidth(!1):mCSB_container.outerHeight(!1),contentOffset="x"===dir?mCSB_container.offset().left:mCSB_container.offset().top,contentPos="x"===dir?mCSB_container[0].offsetLeft:mCSB_container[0].offsetTop,cssProp="x"===dir?"left":"top";switch(t){case"function":return val();case"object":if(val.nodeType)var objOffset="x"===dir?$(val).offset().left:$(val).offset().top;else if(val.jquery){if(!val.length)return;var objOffset="x"===dir?val.offset().left:val.offset().top}return objOffset-contentOffset;case"string":case"number":if(functions._isNumeric.call(null,val))return Math.abs(val);if(-1!==val.indexOf("%"))return Math.abs(contentLength*parseInt(val)/100);if(-1!==val.indexOf("-="))return Math.abs(contentPos-parseInt(val.split("-=")[1]));if(-1!==val.indexOf("+=")){var p=contentPos+parseInt(val.split("+=")[1]);return p>=0?0:Math.abs(p)}if(-1!==val.indexOf("px")&&functions._isNumeric.call(null,val.split("px")[0]))return Math.abs(val.split("px")[0]);if("top"===val||"left"===val)return 0;if("bottom"===val)return Math.abs(wrapper.height()-mCSB_container.outerHeight(!1));if("right"===val)return Math.abs(wrapper.width()-mCSB_container.outerWidth(!1));if("first"===val||"last"===val){var obj=mCSB_container.find(":"+val),objOffset="x"===dir?$(obj).offset().left:$(obj).offset().top;return objOffset-contentOffset}if($(val).length){var objOffset="x"===dir?$(val).offset().left:$(val).offset().top;return objOffset-contentOffset}return mCSB_container.css(cssProp,val),void methods.update.call(null,$this[0])}}},_autoUpdate:function(rem){function upd(){clearTimeout(mCSB_container[0].autoUpdate),mCSB_container[0].autoUpdate=setTimeout(function(){return o.advanced.updateOnSelectorChange&&(newSelSize=sizesSum(),newSelSize!==oldSelSize)?(doUpd(),void(oldSelSize=newSelSize)):(o.advanced.updateOnContentResize&&(ns=[mCSB_container.outerHeight(!1),mCSB_container.outerWidth(!1),wrapper.height(),wrapper.width(),scrollbarSize()[0],scrollbarSize()[1]],(ns[0]!==os[0]||ns[1]!==os[1]||ns[2]!==os[2]||ns[3]!==os[3]||ns[4]!==os[4]||ns[5]!==os[5])&&(doUpd(),os=ns)),o.advanced.updateOnImageLoad&&(newImgsLen=imgSum(),newImgsLen!==oldImgsLen&&(mCSB_container.find("img").each(function(){imgLoader(this.src)}),oldImgsLen=newImgsLen)),void((o.advanced.updateOnSelectorChange||o.advanced.updateOnContentResize||o.advanced.updateOnImageLoad)&&upd()))},60)}function imgSum(){var total=0;return o.advanced.updateOnImageLoad&&(total=mCSB_container.find("img").length),total}function imgLoader(src){function createDelegate(contextObject,delegateMethod){return function(){return delegateMethod.apply(contextObject,arguments)}}function imgOnLoad(){this.onload=null,doUpd()}var img=new Image;img.onload=createDelegate(img,imgOnLoad),img.src=src}function sizesSum(){o.advanced.updateOnSelectorChange===!0&&(o.advanced.updateOnSelectorChange="*");var total=0,sel=mCSB_container.find(o.advanced.updateOnSelectorChange);return o.advanced.updateOnSelectorChange&&sel.length>0&&sel.each(function(){total+=$(this).height()+$(this).width()}),total}function doUpd(){clearTimeout(mCSB_container[0].autoUpdate),methods.update.call(null,$this[0])}var $this=$(this),d=$this.data(pluginPfx),o=d.opt,mCSB_container=$("#mCSB_"+d.idx+"_container");if(rem)return clearTimeout(mCSB_container[0].autoUpdate),void functions._delete.call(null,mCSB_container[0].autoUpdate);var newSelSize,ns,newImgsLen,wrapper=mCSB_container.parent(),scrollbar=[$("#mCSB_"+d.idx+"_scrollbar_vertical"),$("#mCSB_"+d.idx+"_scrollbar_horizontal")],scrollbarSize=function(){return[scrollbar[0].is(":visible")?scrollbar[0].outerHeight(!0):0,scrollbar[1].is(":visible")?scrollbar[1].outerWidth(!0):0]},oldSelSize=sizesSum(),os=[mCSB_container.outerHeight(!1),mCSB_container.outerWidth(!1),wrapper.height(),wrapper.width(),scrollbarSize()[0],scrollbarSize()[1]],oldImgsLen=imgSum();upd()},_snapAmount:function(to,amount,offset){return Math.round(to/amount)*amount-offset},_stop:function(el){var d=el.data(pluginPfx),sel=$("#mCSB_"+d.idx+"_container,#mCSB_"+d.idx+"_container_wrapper,#mCSB_"+d.idx+"_dragger_vertical,#mCSB_"+d.idx+"_dragger_horizontal");sel.each(function(){functions._stopTween.call(this)})},_scrollTo:function(el,to,options){function _cb(cb){return d&&o.callbacks[cb]&&"function"==typeof o.callbacks[cb]}function _cbOffsets(){return[o.callbacks.alwaysTriggerOffsets||contentPos>=limit[0]+tso,o.callbacks.alwaysTriggerOffsets||-tsbo>=contentPos]}function _mcs(){var cp=[mCSB_container[0].offsetTop,mCSB_container[0].offsetLeft],dp=[mCSB_dragger[0].offsetTop,mCSB_dragger[0].offsetLeft],cl=[mCSB_container.outerHeight(!1),mCSB_container.outerWidth(!1)],pl=[mCustomScrollBox.height(),mCustomScrollBox.width()];el[0].mcs={content:mCSB_container,top:cp[0],left:cp[1],draggerTop:dp[0],draggerLeft:dp[1],topPct:Math.round(100*Math.abs(cp[0])/(Math.abs(cl[0])-pl[0])),leftPct:Math.round(100*Math.abs(cp[1])/(Math.abs(cl[1])-pl[1])),direction:options.dir}}var d=el.data(pluginPfx),o=d.opt,defaults={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:o.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},options=$.extend(defaults,options),dur=[options.dur,options.drag?0:options.dur],mCustomScrollBox=$("#mCSB_"+d.idx),mCSB_container=$("#mCSB_"+d.idx+"_container"),wrapper=mCSB_container.parent(),totalScrollOffsets=o.callbacks.onTotalScrollOffset?functions._arr.call(el,o.callbacks.onTotalScrollOffset):[0,0],totalScrollBackOffsets=o.callbacks.onTotalScrollBackOffset?functions._arr.call(el,o.callbacks.onTotalScrollBackOffset):[0,0];if(d.trigger=options.trigger,(0!==wrapper.scrollTop()||0!==wrapper.scrollLeft())&&($(".mCSB_"+d.idx+"_scrollbar").css("visibility","visible"),wrapper.scrollTop(0).scrollLeft(0)),"_resetY"!==to||d.contentReset.y||(_cb("onOverflowYNone")&&o.callbacks.onOverflowYNone.call(el[0]),d.contentReset.y=1),"_resetX"!==to||d.contentReset.x||(_cb("onOverflowXNone")&&o.callbacks.onOverflowXNone.call(el[0]),d.contentReset.x=1),"_resetY"!==to&&"_resetX"!==to){switch(!d.contentReset.y&&el[0].mcs||!d.overflowed[0]||(_cb("onOverflowY")&&o.callbacks.onOverflowY.call(el[0]),d.contentReset.x=null),!d.contentReset.x&&el[0].mcs||!d.overflowed[1]||(_cb("onOverflowX")&&o.callbacks.onOverflowX.call(el[0]),d.contentReset.x=null),o.snapAmount&&(to=functions._snapAmount(to,o.snapAmount,o.snapOffset)),options.dir){case"x":var mCSB_dragger=$("#mCSB_"+d.idx+"_dragger_horizontal"),property="left",contentPos=mCSB_container[0].offsetLeft,limit=[mCustomScrollBox.width()-mCSB_container.outerWidth(!1),mCSB_dragger.parent().width()-mCSB_dragger.width()],scrollTo=[to,0===to?0:to/d.scrollRatio.x],tso=totalScrollOffsets[1],tsbo=totalScrollBackOffsets[1],totalScrollOffset=tso>0?tso/d.scrollRatio.x:0,totalScrollBackOffset=tsbo>0?tsbo/d.scrollRatio.x:0;break;case"y":var mCSB_dragger=$("#mCSB_"+d.idx+"_dragger_vertical"),property="top",contentPos=mCSB_container[0].offsetTop,limit=[mCustomScrollBox.height()-mCSB_container.outerHeight(!1),mCSB_dragger.parent().height()-mCSB_dragger.height()],scrollTo=[to,0===to?0:to/d.scrollRatio.y],tso=totalScrollOffsets[0],tsbo=totalScrollBackOffsets[0],totalScrollOffset=tso>0?tso/d.scrollRatio.y:0,totalScrollBackOffset=tsbo>0?tsbo/d.scrollRatio.y:0}scrollTo[1]<0||0===scrollTo[0]&&0===scrollTo[1]?scrollTo=[0,0]:scrollTo[1]>=limit[1]?scrollTo=[limit[0],limit[1]]:scrollTo[0]=-scrollTo[0],el[0].mcs||(_mcs(),_cb("onInit")&&o.callbacks.onInit.call(el[0])),clearTimeout(mCSB_container[0].onCompleteTimeout),(d.tweenRunning||!(0===contentPos&&scrollTo[0]>=0||contentPos===limit[0]&&scrollTo[0]<=limit[0]))&&(functions._tweenTo.call(null,mCSB_dragger[0],property,Math.round(scrollTo[1]),dur[1],options.scrollEasing),functions._tweenTo.call(null,mCSB_container[0],property,Math.round(scrollTo[0]),dur[0],options.scrollEasing,options.overwrite,{onStart:function(){options.callbacks&&options.onStart&&!d.tweenRunning&&(_cb("onScrollStart")&&(_mcs(),o.callbacks.onScrollStart.call(el[0])),d.tweenRunning=!0,functions._onDragClasses(mCSB_dragger),d.cbOffsets=_cbOffsets())},onUpdate:function(){options.callbacks&&options.onUpdate&&_cb("whileScrolling")&&(_mcs(),o.callbacks.whileScrolling.call(el[0]))},onComplete:function(){if(options.callbacks&&options.onComplete){"yx"===o.axis&&clearTimeout(mCSB_container[0].onCompleteTimeout);var t=mCSB_container[0].idleTimer||0;mCSB_container[0].onCompleteTimeout=setTimeout(function(){_cb("onScroll")&&(_mcs(),o.callbacks.onScroll.call(el[0])),_cb("onTotalScroll")&&scrollTo[1]>=limit[1]-totalScrollOffset&&d.cbOffsets[0]&&(_mcs(),o.callbacks.onTotalScroll.call(el[0])),_cb("onTotalScrollBack")&&scrollTo[1]<=totalScrollBackOffset&&d.cbOffsets[1]&&(_mcs(),o.callbacks.onTotalScrollBack.call(el[0])),d.tweenRunning=!1,mCSB_container[0].idleTimer=0,functions._onDragClasses(mCSB_dragger,"hide")},t)}}}))}},_tweenTo:function(el,prop,to,duration,easing,overwrite,callbacks){function _step(){tobj.stop||(progress||onStart.call(),progress=functions._getTime()-startTime,_tween(),progress>=tobj.time&&(tobj.time=progress>tobj.time?progress+_delay-(progress-tobj.time):progress+_delay-1,tobj.time<progress+1&&(tobj.time=progress+1)),tobj.time<duration?tobj.id=_request(_step):onComplete.call())}function _tween(){duration>0?(tobj.currVal=_ease(tobj.time,from,diff,duration,easing),elStyle[prop]=Math.round(tobj.currVal)+"px"):elStyle[prop]=to+"px",onUpdate.call()}function _startTween(){_delay=1e3/60,tobj.time=progress+_delay,_request=window.requestAnimationFrame?window.requestAnimationFrame:function(f){return _tween(),setTimeout(f,.01)},tobj.id=_request(_step)}function _cancelTween(){null!=tobj.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(tobj.id):clearTimeout(tobj.id),tobj.id=null)}function _ease(t,b,c,d,type){switch(type){case"linear":case"mcsLinear":return c*t/d+b;case"mcsLinearOut":return t/=d,t--,c*Math.sqrt(1-t*t)+b;case"easeInOutSmooth":return t/=d/2,1>t?c/2*t*t+b:(t--,-c/2*(t*(t-2)-1)+b);case"easeInOutStrong":return t/=d/2,1>t?c/2*Math.pow(2,10*(t-1))+b:(t--,c/2*(-Math.pow(2,-10*t)+2)+b);case"easeInOut":case"mcsEaseInOut":return t/=d/2,1>t?c/2*t*t*t+b:(t-=2,c/2*(t*t*t+2)+b);case"easeOutSmooth":return t/=d,t--,-c*(t*t*t*t-1)+b;case"easeOutStrong":return c*(-Math.pow(2,-10*t/d)+1)+b;case"easeOut":case"mcsEaseOut":default:var ts=(t/=d)*t,tc=ts*t;return b+c*(.499999999999997*tc*ts+-2.5*ts*ts+5.5*tc+-6.5*ts+4*t)}}el._malihuTween||(el._malihuTween={top:{},left:{}});var _delay,_request,callbacks=callbacks||{},onStart=callbacks.onStart||function(){},onUpdate=callbacks.onUpdate||function(){},onComplete=callbacks.onComplete||function(){},startTime=functions._getTime(),progress=0,from=el.offsetTop,elStyle=el.style,tobj=el._malihuTween[prop];"left"===prop&&(from=el.offsetLeft);var diff=to-from;tobj.stop=0,"none"!==overwrite&&_cancelTween(),_startTween()},_getTime:function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},_stopTween:function(){var el=this;el._malihuTween||(el._malihuTween={top:{},left:{}}),el._malihuTween.top.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(el._malihuTween.top.id):clearTimeout(el._malihuTween.top.id),el._malihuTween.top.id=null,el._malihuTween.top.stop=1),el._malihuTween.left.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(el._malihuTween.left.id):clearTimeout(el._malihuTween.left.id),el._malihuTween.left.id=null,el._malihuTween.left.stop=1)},_delete:function(p){try{delete p}catch(e){p=null}},_mouseBtnLeft:function(e){return!(e.which&&1!==e.which)},_pointerTouch:function(e){var t=e.originalEvent.pointerType;return!(t&&"touch"!==t&&2!==t)},_isNumeric:function(val){return!isNaN(parseFloat(val))&&isFinite(val)}};$.fn[pluginNS]=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist"):methods.init.apply(this,arguments)},$[pluginNS]=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist"):methods.init.apply(this,arguments)},$[pluginNS].defaults=defaults,window[pluginNS]=!0,$(window).load(function(){$(defaultSelector)[pluginNS]()})})}(jQuery,window,document),$(document).ready(function(){initHash(),initCache(),changeCharacter(),showPopup(),closePopup(),$("html").hasClass("-device_desktop")}),$(window).resize(function(){}),$(window).load(function(){initCustomScroll()});var questions=["   <br/> ","   ?","   ","      ","  ?"," <br/>  "," ?<br/>   !","    ","     ","<br/> ??","     !","     ?","    ,   !",' "",  !'],arrObj=[{que:"   ?",ans:"    "}],answersCharacter={a:["  ","  .",",     ",",  .",",   "," .   .    ","   !"," . , ",",    ?"," Ctrl+F5","     ","    !","    "],y:["   ","  .","  .    ",",     ",",  .",",   ","   !","     ",".   .   ","     ","    "," . , ","  . "],r:["  ","  .",",     ",",  .",",   "," .   .    ","   !","     ","     ","     ",",    ?"," Ctrl+F5","     ","    !","    "]};